# Harbor Configuration Secret
apiVersion: v1
kind: Secret
metadata:
  name: harbor-config
  namespace: harbor-system
type: Opaque
stringData:
  harbor.yml: |
    # Harbor enterprise configuration for Opifex
    hostname: harbor.opifex.local

    # HTTP and HTTPS configuration
    http:
      port: 80

    https:
      port: 443
      certificate: /etc/harbor/certs/tls.crt
      private_key: /etc/harbor/certs/tls.key

    # Harbor admin settings
    harbor_admin_password: "secure-admin-password"  # Change in production

    # Database configuration (PostgreSQL)
    database:
      password: "secure-db-password"  # Change in production
      max_idle_conns: 100
      max_open_conns: 900
      conn_max_lifetime: 5m
      conn_max_idle_time: 0

    # Data volume configuration
    data_volume: /data

    # Trivy security scanner configuration
    trivy:
      ignore_unfixed: false
      skip_update: false
      offline_scan: false
      security_check: vuln
      insecure: false
      github_token: ""
      timeout: 5m0s

    # Job service configuration for scanning
    jobservice:
      max_job_workers: 10
      logger_sweeper_duration: 1
      logger_level: info

    # Notification settings
    notification:
      webhook_job_max_retry: 10
      webhook_job_http_client_timeout: 3s

    # Chart repository
    chart:
      absolute_url: disabled

    # Docker registry
    docker_registry:
      notification_timeout: 30s

    # Log configuration
    log:
      level: info
      local:
        rotate_count: 50
        rotate_size: 200M
        location: /var/log/harbor

    # Garbage collection
    _version: 2.10.0
