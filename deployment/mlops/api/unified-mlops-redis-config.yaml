apiVersion: v1
kind: ConfigMap
metadata:
  name: redis-config
  namespace: opifex-mlops
  labels:
    app.kubernetes.io/name: redis
    app.kubernetes.io/component: cache
    app.kubernetes.io/instance: unified-mlops-redis
data:
  redis.conf: |
    # Redis configuration optimized for MLOps API caching

    # Network and connection settings
    bind 0.0.0.0
    port 6379
    timeout 300
    tcp-keepalive 60

    # Memory management
    maxmemory 512mb
    maxmemory-policy allkeys-lru

    # Persistence (disabled for cache use case)
    save ""

    # Logging
    loglevel notice
    logfile ""

    # Security
    protected-mode yes
    requirepass ${REDIS_PASSWORD}

    # Performance tuning
    databases 16
    hash-max-ziplist-entries 512
    hash-max-ziplist-value 64
    list-max-ziplist-size -2
    list-compress-depth 0
    set-max-intset-entries 512
    zset-max-ziplist-entries 128
    zset-max-ziplist-value 64

    # Client connections
    maxclients 10000

    # Memory optimization
    rdbcompression yes
    rdbchecksum yes
